# Настройка Google Tag Manager

## События, которые отправляются в GTM

### 1. События форм

#### `form_start` - Начало заполнения формы
Срабатывает при первом фокусе на любом поле формы.

**Параметры:**
- `form_name` - название формы (например, "Главная страница")
- `form_type` - тип формы (contact, beta, sidebar, modal)
- `form_id` - ID формы в HTML

**Пример:**
```javascript
{
  event: 'form_start',
  form_name: 'Главная страница',
  form_type: 'contact',
  form_id: 'contactForm'
}
```

#### `form_submit_attempt` - Попытка отправки формы
Срабатывает при нажатии кнопки "Отправить".

**Параметры:**
- `form_name` - название формы
- `form_type` - тип формы
- `form_id` - ID формы

#### `form_submit_success` - Успешная отправка формы
Срабатывает после успешной отправки в Telegram.

**Параметры:**
- `form_name` - название формы
- `form_type` - тип формы
- `form_id` - ID формы

#### `form_submit_error` - Ошибка отправки формы
Срабатывает при ошибке отправки.

**Параметры:**
- `form_name` - название формы
- `form_type` - тип формы
- `error_type` - тип ошибки (api_error, network_error)

#### `conversion` - Конверсия (лид)
Срабатывает после успешной отправки формы.

**Параметры:**
- `conversion_type` - тип конверсии (lead)
- `form_name` - название формы

---

### 2. События кнопок

#### `button_click` - Клик по CTA кнопке
Срабатывает при клике на главные кнопки действия.

**Параметры:**
- `button_text` - текст кнопки
- `button_location` - расположение (hero, services и т.д.)
- `button_type` - тип кнопки (cta)

#### `project_click` - Клик по проекту
Срабатывает при клике на карточку проекта.

**Параметры:**
- `project_name` - название проекта
- `click_location` - где кликнули (project_card)

#### `social_click` - Клик по соцсети
Срабатывает при клике на ссылку соцсети.

**Параметры:**
- `social_network` - название соцсети
- `link_url` - URL ссылки

#### `email_click` - Клик по email
Срабатывает при клике на email ссылку.

**Параметры:**
- `email` - адрес email

#### `modal_open` - Открытие модального окна
Срабатывает при открытии модального окна.

**Параметры:**
- `modal_type` - тип модального окна (contact)

---

## Как настроить в GTM

### Шаг 1: Создать триггеры

1. Зайди в GTM → **Триггеры** → **Создать**
2. Выбери тип: **Специальное событие**
3. Название события: `form_submit_success` (или другое из списка выше)
4. Сохрани

Создай триггеры для всех нужных событий.

### Шаг 2: Создать переменные (опционально)

Для удобства можешь создать переменные:

1. **Переменные** → **Создать**
2. Тип: **Переменная уровня данных**
3. Название переменной уровня данных: `form_name` (или другие параметры)

### Шаг 3: Создать теги

#### Пример: Отслеживание конверсий в Google Ads

1. **Теги** → **Создать**
2. Тип тега: **Google Ads - Конверсия**
3. ID конверсии: твой ID
4. Ярлык конверсии: твой ярлык
5. Триггер: `conversion`
6. Сохрани и опубликуй

#### Пример: Отслеживание событий в Google Analytics 4

1. **Теги** → **Создать**
2. Тип тега: **Google Аналитика: событие GA4**
3. Название события: `{{Event}}` (будет брать из dataLayer)
4. Параметры события:
   - `form_name` = `{{form_name}}`
   - `form_type` = `{{form_type}}`
5. Триггер: выбери нужные события
6. Сохрани и опубликуй

#### Пример: Отслеживание в Яндекс.Метрике

1. **Теги** → **Создать**
2. Тип тега: **Пользовательский HTML**
3. HTML:
```html
<script>
  ym(ТВОЙ_НОМЕР_СЧЕТЧИКА, 'reachGoal', 'form_submit_success', {
    form_name: {{form_name}},
    form_type: {{form_type}}
  });
</script>
```
4. Триггер: `form_submit_success`
5. Сохрани и опубликуй

---

## Проверка работы

### В консоли браузера

1. Открой сайт
2. Открой DevTools (F12)
3. В консоли введи: `dataLayer`
4. Выполни действие (заполни форму, кликни кнопку)
5. Снова введи `dataLayer` - должны появиться новые события

### В режиме предварительного просмотра GTM

1. В GTM нажми **Предварительный просмотр**
2. Введи URL сайта
3. Выполняй действия на сайте
4. В окне GTM будут отображаться все события в реальном времени

---

## Рекомендуемые цели для отслеживания

### Основные конверсии:
- ✅ `form_submit_success` - успешная отправка формы (главная цель)
- ✅ `conversion` - конверсия для рекламы

### Микроконверсии:
- `form_start` - начало заполнения формы
- `button_click` - клики по CTA
- `project_click` - просмотр проектов
- `email_click` - клик по email
- `social_click` - переход в соцсети

### Для оптимизации:
- `form_submit_error` - ошибки отправки (нужно исправлять)
- `modal_open` - открытие модального окна

---

## Полезные ссылки

- [Google Tag Manager](https://tagmanager.google.com/)
- [Документация GTM](https://support.google.com/tagmanager)
- [Google Analytics 4](https://analytics.google.com/)
- [Яндекс.Метрика](https://metrika.yandex.ru/)
